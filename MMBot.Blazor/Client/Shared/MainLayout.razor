@inherits LayoutComponentBase

<MudDialogProvider />
<MudSnackbarProvider />
<MudThemeProvider Theme="currentTheme"/>

<MudLayout>
    <MudAppBar Elevation="2">
        <MudIconButton Icon="@Icons.Material.Filled.Menu" Color="Color.Inherit" Edge="Edge.Start" OnClick="@((e) => DrawerToggle())" />
        <MudText Typo="Typo.h5">@AppDefaults.AppName</MudText>

        <AuthorizeView>
            <Authorized>
                <MudGrid>
                    <MudItem xs="12">
                        <MudGrid Spacing="5" Justify="Justify.FlexEnd">
                            <MudItem>
                                <MudAvatar Image="@LoggedUser.AvatarUrl"/>
                            </MudItem>
                            <MudItem>
                                <MudText Typo="Typo.h6">Hello, @LoggedUser.Name!</MudText>
                            </MudItem>
                            <MudItem Style="min-width: max-content">
                                <MudSelect T="DCChannel" Label="Guild" FullWidth="true" Value="@SelectedGuild" ValueChanged="GuildChanged" Text="@SelectedGuild.Name">
                                    @foreach (var guild in Guilds)
                                    {
                                        <MudSelectItem T="DCChannel" value="@guild">@guild.Name</MudSelectItem>
                                    }
                                </MudSelect>
                            </MudItem>
                            <MudItem>
                                <MudLink Typo="Typo.h6" Color="Color.Inherit" Href="@ApiAuthDefaults.LogOutPath">Log out</MudLink>
                            </MudItem>
                        </MudGrid>
                    </MudItem>
                </MudGrid>
            </Authorized>
            <NotAuthorized>
                <MudGrid>
                    <MudItem xs="12">
                        <MudGrid Spacing="5" Justify="Justify.FlexEnd">
                            <MudItem>
                                <MudLink Typo="Typo.h6" Class="ml-3" Href="@ApiAuthDefaults.LogInPath">Log in</MudLink>
                            </MudItem>
                        </MudGrid>
                    </MudItem>
                </MudGrid>
            </NotAuthorized>
        </AuthorizeView>
    </MudAppBar>
    <MudDrawer @bind-Open="_drawerOpen" ClipMode="DrawerClipMode.Always" Elevation="2">
        <MudPaper Width="Auto" Class="py-3" Square="true">
            <NavMenu />
        </MudPaper>
    </MudDrawer>
    <MudMainContent>
        @Body
    </MudMainContent>
</MudLayout>
